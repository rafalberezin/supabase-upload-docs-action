# Getting Started

This quick start guide will walk you through basic setup for the action. This
guide will use the default names, but later you can dive deeper into design
patterns to understand it better and configure the action to your liking.

## Quick Explanation

The action will upload new or changed files from the configured path in your
repository (default: `docs/articles`) and upload them into the specified storage
bucket. When you delete files, the action will also delete them from supabase
storage.

The files are uploaded to your storage bucket using the following path pattern:

```path
<project slug>/<storage-articles-dir>/<generated path> # For articles
<project slug>/<storage-assets-dir>/<generated path>   # For assets
```

Where:

- `<project slug>` is the project identifier. (e.g., `my-project`)
- `<storage-articles-dir>` is the value specified by the input of the same name.
  (default: `articles`)
- `<storage-assets-dir>` is the value specified by the input of the same name.
  (optional)
- `<generated path>` is a path mirroring your local directory structure, but
  composed of slugs, with optional prefix trimming.

You can learn more about this in
[Slugs and Titles](./02-core-concepts/00-slugs-and-titles.md) and
[Storage Structure](./02-core-concepts/01-storage-structure.md).

## Prerequisites

Before setting up the action, ensure that you have:

- A **GitHub repository** with documentation stored in `docs/articles`.
- Admin access to your GitHub repository to set up secrets.
- A **Supabase project** with access to:
  - Storage service.
  - Database service (if using metadata management).

## Step 1: Configure Supabase

### Storage Setup

1. Log in to your Supabase project dashboard.
2. Navigate to the **Storage** section.
3. Create a new bucket (default: `projects`).

> [!TIP]
>
> For public documentation you might want to set RLS policies to allow anonymous
> reads.

### Database Setup (Optional)

If you plan to use metadata management:

1. Navigate to the **Table Editor** in your Supabase dashboard.
2. Create a new table for your documentation metadata (e.g., `projects`).
3. Configure the necessary columns based on your needs. For simplicity we'll
   store all available data, but you can customize that using
   [Column Mappings](./03-configuration.md#column-mappings).

You can also use **SQL Editor** to create the table with a query:

```sql title=Example table
CREATE TABLE projects (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	slug TEXT UNIQUE NOT NULL,
	title TEXT NOT NULL,
	description TEXT,
	license TEXT,
	source TEXT,
	latest_version TEXT,
	versions TEXT[],
	articles JSONB
);
```

## Step 2: Add Secrets to GitHub Repository

1. Go to your GitHub repository.
2. Navigate to Settings > Secrets and variables > Action.
3. Add the following repository secrets:
   - `SUPABASE_URL`: Your Supabase project URL.
   - `SUPABASE_KEY`: Your Supabase project API key (with storage permissions,
     and database permissions if using).

## Step 3: Prepare Your Documentation Structure

1. Create a `docs` directory in your repository.
2. Add subdirectories for `articles` and `assets`.
3. Create a metadata file if needed.

```tree title=Example structure
docs/
├── articles/
│   ├── 00-getting-started.md
│   └── 01-features/
│       └── 00-basic-features.md
├── assets/
│   └── logo.svg
└── meta.yml
```

You can find more about metadata file in
[Metadata Management](./02-core-concepts/02-metadata-management.md#metadata-file).

## Step 4: Set Up GitHub Workflow

Create a workflow file in `.github/workflows`. (e.g., `docs.yml`)

> [!TIP]
>
> It's a good idea to set up the workflow only to run when the documentation
> changes. See **line 5** in the example.

> [!IMPORTANT]
>
> The action operates on the files locally, so you need to download them first,
> for example using the `checkout` action. See **line 11** in the example.

```yaml lines|title=Example minimal setup|highlight=5,11
name: Upload documentation
on:
  push:
    branches: [master, main]
    paths: [docs/**]

jobs:
  upload-docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: rafalberezin/supabase-upload-docs-action@v1
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          supabase-url: ${{ secrets.SUPABASE_URL }}
          supabase-key: ${{ secrets.SUPABASE_KEY }}
          articles-path: docs/articles
          storage-bucket: projects
```

## Next Steps

- [Slugs And Titles](./02-core-concepts/00-slugs-and-titles.md) - Learn how
  paths and titles are generated.
